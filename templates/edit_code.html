{% extends "base_template.html" %}
{% block title %}Edit Code - HoofPrint{% endblock %}

{% block scripts %}
<script src="/static/edit_form.js"></script>
{% endblock scripts %}

{% block content %}
<div>
    <h2>Edit Code</h2>

    {% if let Some(error_string) = error %}
    <div class="error">
        <strong>Error:</strong> {{ error_string }}
    </div>
    {% endif %}

    <form method="post" action="/edit/{{ code_id }}">
        <div class="form_box">
            <label for="code_type" class="form_label">Code Type:</label>
            <select id="code_type" name="code_type" required>
                <option value>-- Select Type --</option>
                <option value="barcode" {% if code_type == "barcode" %}selected{% endif %}>Barcode</option>
                <option value="qrcode" {% if code_type == "qrcode" %}selected{% endif %}>QR Code</option>
            </select>
        </div>

        <div class="form_box">
            <label for="code_value" class="form_label">Code Value:</label>
            <input type="text" id="code_value" name="code_value" value="{{ code_value }}" required maxlength="255"
                class="form_input" placeholder="Enter code value (max 255 characters)" />
            <small class="form_sublabel">The barcode/QR code value to encode</small>
        </div>

        <div>
            <label for="code_name" class="form_label">Name (Optional):</label>
            <input type="text" id="code_name" name="code_name"
                value="{% if let Some(name) = code_name %}{{ name }}{% endif %}"
                maxlength="255"
                class="form_input"
                placeholder="Give this code a friendly name">
            <small class="form_sublabel">An optional name to help identify this code</small>
        </div>

        <div class="form_box">
            <label for="site_id" class="form_label">Site:</label>
            <select id="site_id" name="site_id" required class="form_select">
                <option value>-- Select Site --</option>
                {% for site in sites %}
                <option value="{{ site.id }}" {% if site.id == site_id %}selected{% endif %}>{{ site.name }}</option>
                {% endfor %}
            </select>
            <small class="form_sublabel">The site/shop this code is for</small>
        </div>

        <div class="info_box">
            <div>
                <strong>Created:</strong> {{ created_at }}
            </div>
            {% if let Some(last_updated) = last_updated %}
            <div>
                <strong>Last Updated:</strong> {{ last_updated }}
            </div>
            {% endif %}
        </div>

        <div class="form_buttons">
            <div>
                <button type="submit"
                    class="btn btn-blue">Update
                    Code</button>

            </div>
            <div>
                <a href="/view/{{ code_id }}"><button class="btn btn-red" type="button">Cancel</button></a>
            </div>

            <div style="flex-grow: 1;"></div>
            <div>
                <button type="button" onclick="confirmDelete()"
                    class="btn btn-red">Delete Code</button>
            </div>
        </div>
    </form>

    <form id="deleteForm" method="post" action="/delete/{{ code_id }}" class="hidden"></form>

</div>
{% endblock content %}
